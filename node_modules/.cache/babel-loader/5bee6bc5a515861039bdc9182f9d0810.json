{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst prosemirror_utils_1 = require(\"prosemirror-utils\");\n\nfunction findCollapsedNodes(doc) {\n  const blocks = prosemirror_utils_1.findBlockNodes(doc);\n  const nodes = [];\n  let withinCollapsedHeading;\n\n  for (const block of blocks) {\n    if (block.node.type.name === \"heading\") {\n      if (!withinCollapsedHeading || block.node.attrs.level <= withinCollapsedHeading) {\n        if (block.node.attrs.collapsed) {\n          if (!withinCollapsedHeading) {\n            withinCollapsedHeading = block.node.attrs.level;\n          }\n        } else {\n          withinCollapsedHeading = undefined;\n        }\n\n        continue;\n      }\n    }\n\n    if (withinCollapsedHeading) {\n      nodes.push(block);\n    }\n  }\n\n  return nodes;\n}\n\nexports.default = findCollapsedNodes;","map":{"version":3,"sources":["../../src/queries/findCollapsedNodes.ts"],"names":[],"mappings":";;;;;;AAAA,MAAA,mBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AAGA,SAAwB,kBAAxB,CAA2C,GAA3C,EAAoD;AAClD,QAAM,MAAM,GAAG,mBAAA,CAAA,cAAA,CAAe,GAAf,CAAf;AACA,QAAM,KAAK,GAAkB,EAA7B;AAEA,MAAI,sBAAJ;;AAEA,OAAK,MAAM,KAAX,IAAoB,MAApB,EAA4B;AAC1B,QAAI,KAAK,CAAC,IAAN,CAAW,IAAX,CAAgB,IAAhB,KAAyB,SAA7B,EAAwC;AACtC,UACE,CAAC,sBAAD,IACA,KAAK,CAAC,IAAN,CAAW,KAAX,CAAiB,KAAjB,IAA0B,sBAF5B,EAGE;AACA,YAAI,KAAK,CAAC,IAAN,CAAW,KAAX,CAAiB,SAArB,EAAgC;AAC9B,cAAI,CAAC,sBAAL,EAA6B;AAC3B,YAAA,sBAAsB,GAAG,KAAK,CAAC,IAAN,CAAW,KAAX,CAAiB,KAA1C;AACD;AACF,SAJD,MAIO;AACL,UAAA,sBAAsB,GAAG,SAAzB;AACD;;AACD;AACD;AACF;;AAED,QAAI,sBAAJ,EAA4B;AAC1B,MAAA,KAAK,CAAC,IAAN,CAAW,KAAX;AACD;AACF;;AAED,SAAO,KAAP;AACD;;AA7BD,OAAA,CAAA,OAAA,GAAA,kBAAA","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst prosemirror_utils_1 = require(\"prosemirror-utils\");\nfunction findCollapsedNodes(doc) {\n    const blocks = prosemirror_utils_1.findBlockNodes(doc);\n    const nodes = [];\n    let withinCollapsedHeading;\n    for (const block of blocks) {\n        if (block.node.type.name === \"heading\") {\n            if (!withinCollapsedHeading ||\n                block.node.attrs.level <= withinCollapsedHeading) {\n                if (block.node.attrs.collapsed) {\n                    if (!withinCollapsedHeading) {\n                        withinCollapsedHeading = block.node.attrs.level;\n                    }\n                }\n                else {\n                    withinCollapsedHeading = undefined;\n                }\n                continue;\n            }\n        }\n        if (withinCollapsedHeading) {\n            nodes.push(block);\n        }\n    }\n    return nodes;\n}\nexports.default = findCollapsedNodes;\n"]},"metadata":{},"sourceType":"script"}